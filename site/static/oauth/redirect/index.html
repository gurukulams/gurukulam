<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Required tro stop sec : To be removed -->
    <meta name=”robots” content=”noindex”>
    <title>Gurukulams</title>
</head>
<body>
    <script type="text/javascript">
        const params = new URLSearchParams(window.location.search)
        console.log("Welcome to OAuth {}", params.get("token"));

        fetch('/api/auth/me', {
            headers: {
                "content-type": "application/json",
                Authorization: "Bearer " + params.get("token"),
            },
        })
            .then(response => response.json())
            .then(data => {
                data.authToken = params.get("token");
                data.expiresIn = Date.now() + data.expiresIn;
                sessionStorage.auth = JSON.stringify(data);
                const refPage = sessionStorage.getItem("ref_page")
                sessionStorage.removeItem("key");
                window.location.href = refPage;
            });

    </script>
</body>

</html>